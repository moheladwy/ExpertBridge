@page "/Error"
@using System.Diagnostics

<PageTitle>Error</PageTitle>

<RadzenStack Gap="1.5rem" class="rz-p-4 rz-p-md-12">
    <RadzenCard>
        <RadzenStack Gap="1rem">
            <RadzenText TextStyle="TextStyle.H3" TagName="TagName.H1" class="rz-color-danger">
                Error.
            </RadzenText>
            <RadzenText TextStyle="TextStyle.H5" TagName="TagName.H2" class="rz-color-danger">
                An error occurred while processing your request.
            </RadzenText>

            @if (ShowRequestId)
            {
                <RadzenAlert AlertStyle="AlertStyle.Danger" Variant="Variant.Flat" Shade="Shade.Lighter">
                    <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem" AlignItems="AlignItems.Center">
                        <RadzenText TextStyle="TextStyle.Body1">
                            <strong>Request ID:</strong>
                        </RadzenText>
                        <RadzenBadge BadgeStyle="BadgeStyle.Light" Text="@RequestId" />
                    </RadzenStack>
                </RadzenAlert>
            }
        </RadzenStack>
    </RadzenCard>

    <RadzenCard>
        <RadzenStack Gap="1rem">
            <RadzenText TextStyle="TextStyle.H5" TagName="TagName.H3">
                Development Mode
            </RadzenText>

            <RadzenText TextStyle="TextStyle.Body1">
                Swapping to <RadzenBadge BadgeStyle="BadgeStyle.Info" Text="Development" /> environment will display more detailed information about the error that occurred.
            </RadzenText>

            <RadzenAlert AlertStyle="AlertStyle.Warning" Variant="Variant.Flat" Shade="Shade.Lighter">
                <RadzenStack Gap="0.5rem">
                    <RadzenText TextStyle="TextStyle.Body1">
                        <strong>The Development environment shouldn't be enabled for deployed applications.</strong>
                    </RadzenText>
                    <RadzenText TextStyle="TextStyle.Body2">
                        It can result in displaying sensitive information from exceptions to end users.
                    </RadzenText>
                </RadzenStack>
            </RadzenAlert>

            <RadzenAlert AlertStyle="AlertStyle.Info" Variant="Variant.Flat" Shade="Shade.Lighter">
                <RadzenText TextStyle="TextStyle.Body2">
                    For local debugging, enable the <RadzenBadge BadgeStyle="BadgeStyle.Info" Text="Development" /> environment by setting the <RadzenBadge BadgeStyle="BadgeStyle.Secondary" Text="ASPNETCORE_ENVIRONMENT" /> environment variable to <RadzenBadge BadgeStyle="BadgeStyle.Info" Text="Development" /> and restarting the app.
                </RadzenText>
            </RadzenAlert>
        </RadzenStack>
    </RadzenCard>
</RadzenStack>

@code{
    [CascadingParameter] private HttpContext? HttpContext { get; set; }

    private string? RequestId { get; set; }
    private bool ShowRequestId => !string.IsNullOrEmpty(RequestId);

    protected override void OnInitialized() =>
        RequestId = Activity.Current?.Id ?? HttpContext?.TraceIdentifier;

}
