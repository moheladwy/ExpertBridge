<div style="border-left: 4px solid var(--rz-border-color); padding-left: 0.75rem; padding-top: 0.5rem; padding-bottom: 0.5rem; margin-bottom: 0.75rem; @(CommentResponse?.ParentCommentId == null ? "" : "margin-left: 1.5rem;")">
    @if (CommentResponse != null)
    {
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Gap="0.75rem">
            <div style="flex-shrink: 0;">
                @if (CommentResponse.Author?.ProfilePictureUrl != null)
                {
                    <RadzenImage Path="@CommentResponse.Author.ProfilePictureUrl"
                                 alt="@($"{CommentResponse.Author.FirstName}'s profile")"
                                 Style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;" />
                }
                else
                {
                    <div style="width: 32px; height: 32px; border-radius: 50%; background-color: var(--rz-secondary-lighter); display: flex; align-items: center; justify-content: center;">
                        <RadzenText TextStyle="TextStyle.Caption" Style="color: var(--rz-text-secondary-color);">
                            @(CommentResponse.Author != null ? CommentResponse.Author.FirstName[0].ToString().ToUpper() : "?")
                        </RadzenText>
                    </div>
                }
            </div>

            <RadzenStack Gap="0.5rem" Style="flex: 1;">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem" Wrap="FlexWrap.Wrap">
                    @if (CommentResponse.Author != null)
                    {
                        <RadzenText TextStyle="TextStyle.Subtitle2" class="rz-font-weight-medium">
                            @CommentResponse.Author.FirstName @CommentResponse.Author.LastName
                        </RadzenText>
                        @if (!string.IsNullOrEmpty(CommentResponse.Author.Username))
                        {
                            <RadzenText TextStyle="TextStyle.Caption" class="rz-color-secondary">
                                @("@" + CommentResponse.Author.Username)
                            </RadzenText>
                        }
                    }
                    else
                    {
                        <RadzenText TextStyle="TextStyle.Subtitle2" class="rz-font-weight-medium">
                            Anonymous
                        </RadzenText>
                    }
                    <RadzenText TextStyle="TextStyle.Caption" class="rz-color-secondary">
                        @CommentResponse.CreatedAt.ToString("MMM dd â€¢ h:mm tt")
                    </RadzenText>
                </RadzenStack>

                <RadzenText TextStyle="TextStyle.Body2">
                    @CommentResponse.Content
                </RadzenText>

                @if (CommentResponse.Medias != null && CommentResponse.Medias.Any())
                {
                    <RadzenRow Gap="0.5rem">
                        @foreach (var media in CommentResponse.Medias)
                        {
                            <RadzenColumn Size="@(CommentResponse.Medias.Count == 1 ? 12 : 6)">
                                @if (media.Type.StartsWith("image"))
                                {
                                    <RadzenImage Path="@media.Url"
                                                 alt="@media.Name"
                                                 Style="border-radius: 8px; width: 100%; height: auto; object-fit: cover;" />
                                }
                                else if (media.Type.StartsWith("video"))
                                {
                                    <video src="@media.Url" controls style="border-radius: 8px; width: 100%;">
                                        Your browser does not support the video tag.
                                    </video>
                                }
                                else
                                {
                                    <RadzenCard Style="padding: 0.5rem;">
                                        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                                            <RadzenIcon Icon="description" />
                                            <RadzenLink Path="@media.Url" Target="_blank" Text="@media.Name" Style="font-size: 0.875rem;" />
                                        </RadzenStack>
                                    </RadzenCard>
                                }
                            </RadzenColumn>
                        }
                    </RadzenRow>
                }

                <RadzenStack Orientation="Orientation.Horizontal" Gap="0.75rem" AlignItems="AlignItems.Center" Style="margin-top: 0.25rem;">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.25rem"
                                 Style="@(CommentResponse.IsUpvoted ? "color: var(--rz-primary);" : "color: var(--rz-text-disabled-color);")">
                        <RadzenIcon Icon="@(CommentResponse.IsUpvoted ? "arrow_upward" : "keyboard_arrow_up")" Style="font-size: 16px;" />
                        <RadzenText TextStyle="TextStyle.Caption">@CommentResponse.Upvotes</RadzenText>
                    </RadzenStack>

                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.25rem"
                                 Style="@(CommentResponse.IsDownvoted ? "color: var(--rz-danger);" : "color: var(--rz-text-disabled-color);")">
                        <RadzenIcon Icon="@(CommentResponse.IsDownvoted ? "arrow_downward" : "keyboard_arrow_down")" Style="font-size: 16px;" />
                        <RadzenText TextStyle="TextStyle.Caption">@CommentResponse.Downvotes</RadzenText>
                    </RadzenStack>

                    <RadzenButton Variant="Variant.Text" Size="ButtonSize.ExtraSmall" Text="Reply" />
                </RadzenStack>

                @if (CommentResponse.Replies != null && CommentResponse.Replies.Any())
                {
                    <RadzenStack Gap="0.75rem" Style="margin-top: 0.75rem;">
                        @foreach (var reply in CommentResponse.Replies)
                        {
                            <Comment CommentResponse="reply" />
                        }
                    </RadzenStack>
                }
            </RadzenStack>
        </RadzenStack>
    }
    else
    {
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Gap="0.75rem">
            <RadzenProgressBarCircular ShowValue="false" Mode="ProgressBarMode.Indeterminate"
                                       Size="ProgressBarCircularSize.Small"
                                       Style="width: 32px; height: 32px; flex-shrink: 0;" />
            <RadzenStack Gap="0.5rem" Style="flex: 1;">
                <RadzenProgressBar ShowValue="false" Mode="ProgressBarMode.Indeterminate" Style="height: 12px; width: 25%;" />
                <RadzenProgressBar ShowValue="false" Mode="ProgressBarMode.Indeterminate" Style="height: 48px;" />
                <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem">
                    <RadzenProgressBar ShowValue="false" Mode="ProgressBarMode.Indeterminate" Style="height: 16px; width: 40px;" />
                    <RadzenProgressBar ShowValue="false" Mode="ProgressBarMode.Indeterminate" Style="height: 16px; width: 40px;" />
                </RadzenStack>
            </RadzenStack>
        </RadzenStack>
    }
</div>
